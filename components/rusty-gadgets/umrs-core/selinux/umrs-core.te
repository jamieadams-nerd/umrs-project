policy_module(umrs_core, 1.0)

########################################
# Types
########################################

# Executable file type
type umrs_core_exec_t;
application_domain(umrs_core_t, umrs_core_exec_t)

########################################
# Allow rules (minimal baseline)
########################################

# Allow basic process behavior
allow umrs_core_t self:process {
    fork
    sigchld
    execmem
};

# Allow standard I/O
allow umrs_core_t self:fd use;
allow umrs_core_t self:filesystem getattr;

# Read shared libraries
allow umrs_core_t lib_t:file { read open getattr map };

# Read system configuration files (adjust as needed)
allow umrs_core_t etc_t:file { read open getattr };

########################################
# Optional: logging (commented by default)
########################################
# allow umrs_core_t var_log_t:file { create write append open };

########################################
# Optional: network (commented by default)
########################################
# allow umrs_core_t node_t:node tcp_recv;
# allow umrs_core_t port_t:tcp_socket name_connect;

