Tune logging

Below are the SAME procedures, rewritten from scratch, pure plain text, sudo-only, with the scheduler steps removed entirely.
This focuses ONLY on tuning /var/log itself and journald behavior for high-performance logging, while explaining LVM impact where it matters.

⸻

GOAL

Optimize a dedicated /var/log filesystem for logging performance and safety.
No block-device scheduler tuning.
Assumes RHEL-style system, XFS or ext4, journald in use, sudo access only.

⸻

	1.	CONFIRM /var/log IS A DEDICATED FILESYSTEM

⸻

	1.	Confirm /var/log is mounted independently:

sudo df -h /var/log

Example output:

Filesystem                     Size  Used Avail Use% Mounted on
/dev/mapper/vg_logs-lv_varlog   20G   4.1G  16G  21% /var/log
	2.	Confirm filesystem type and logical volume:

sudo lsblk -f

Look for an entry where MOUNTPOINT is /var/log and note:
	•	filesystem type (xfs or ext4)
	•	logical volume name

⸻

	2.	TRACE /var/log THROUGH LVM TO UNDERSTAND SCOPE

⸻

This step is awareness, not tuning.
	1.	View the logical volume:

sudo lvdisplay /dev/mapper/vg_logs-lv_varlog
	2.	See which physical volumes back the VG:

sudo pvs
sudo vgs
	3.	Confirm mapping:

sudo lsblk -o NAME,TYPE,SIZE,MOUNTPOINT,PKNAME

Start at /var/log and trace upward to TYPE=disk.

Important understanding:
	•	Mount options apply ONLY to /var/log.
	•	LVM metadata and filesystem behavior are isolated per LV.
	•	These changes will NOT affect other volumes on the same disk.

⸻

	3.	BACK UP fstab

⸻

Before modifying mount options:

sudo cp /etc/fstab /etc/fstab.backup

⸻

	4.	OPTIMIZE /var/log MOUNT OPTIONS

⸻

Goal:
	•	Reduce unnecessary metadata writes
	•	Preserve audit integrity
	•	Remain STIG-friendly

4.1 Edit fstab

sudo vi /etc/fstab

Locate the /var/log line.
Example original:

/dev/mapper/vg_logs-lv_varlog   /var/log   xfs   defaults   0 0

4.2 Recommended mount options for XFS

Use:

noatime,nodiratime,nodev,nosuid,noexec,logbufs=8

Example updated line:

/dev/mapper/vg_logs-lv_varlog   /var/log   xfs   noatime,nodiratime,nodev,nosuid,noexec,logbufs=8   0 0

Explanation:
	•	noatime,nodiratime remove access-time updates (less write traffic)
	•	nodev,nosuid,noexec enforce log-only behavior and STIG expectations
	•	logbufs=8 increases XFS metadata log buffering under concurrent writes

If you are using ext4 instead of XFS, use:

noatime,nodiratime,nodev,nosuid,noexec,data=ordered

4.3 Apply the changes

sudo mount -o remount /var/log

4.4 Verify active options

sudo mount | grep ’ /var/log ’

⸻

	5.	OPTIONAL: SET READ-AHEAD FOR LOGICAL VOLUME

⸻

Logging is mostly sequential writes.
Large read-ahead wastes memory.

5.1 Check current read-ahead

sudo blockdev –getra /dev/mapper/vg_logs-lv_varlog

5.2 Reduce read-ahead conservatively

sudo blockdev –setra 128 /dev/mapper/vg_logs-lv_varlog

This affects only that LV.

5.3 (Optional) Persist read-ahead

If reboot persistence is desired, use a nhỏ systemd unit:

sudo vi /etc/systemd/system/set-ra-varlog.service

Content:

[Unit]
Description=Set read-ahead for /var/log
After=local-fs.target

[Service]
Type=oneshot
ExecStart=/usr/sbin/blockdev –setra 128 /dev/mapper/vg_logs-lv_varlog

[Install]
WantedBy=multi-user.target

Enable it:

sudo systemctl daemon-reload
sudo systemctl enable set-ra-varlog.service

⸻

	6.	CONFIGURE JOURNALD FOR DEDICATED /var/log

⸻

journald is a major writer into /var/log.

6.1 Ensure persistent journal storage exists

sudo mkdir -p /var/log/journal
sudo chown root:systemd-journal /var/log/journal
sudo chmod 2755 /var/log/journal

6.2 Configure journald

sudo vi /etc/systemd/journald.conf

In [Journal], set:

Storage=persistent

Recommended capacity controls:

SystemMaxUse=5G
SystemKeepFree=1G

Adjust for your disk size.

6.3 Sync and rate considerations

Defaults are usually best.
Optional tuning:

SyncIntervalSec=5s

Lower values mean more fsyncs (safer, slower).
Higher values mean fewer fsyncs (faster, riskier).

If experiencing log drops during bursts:

RateLimitIntervalSec=30s
RateLimitBurst=10000

6.4 Restart journald

sudo systemctl restart systemd-journald

⸻

	7.	VERIFY LOGGING HEALTH

⸻

	1.	Generate a test log:

sudo logger “var log tuning verification message”
	2.	Confirm journald writes:

sudo journalctl -n 10
	3.	Confirm files in /var/log:

ls -l /var/log

⸻

	8.	SUMMARY OF IMPACT

⸻

	•	All changes above affect ONLY /var/log or journald behavior.
	•	No block device tuning was done.
	•	Other logical volumes sharing the same disk are unaffected.
	•	These settings improve logging throughput consistency,
reduce metadata churn,
preserve audit integrity,
and remain aligned with hardened RHEL expectations.

If you want next:
	•	A minimal checklist version
	•	STIG/NIST mapping in plain text
	•	Separate /var/log/audit tuning
Just say the word.


Here is a plain-text mapping of the /var/log tuning steps (without any I/O scheduler changes) to STIG, NIST, and CCE. I will stick to what has reasonably clear mappings; some of the more “performance-only” tweaks won’t have formal CCEs.
	1.	Step: Put /var/log on its own dedicated file system (LV or partition)

STIG mapping:

RHEL 9 STIG:
STIG ID: RHEL-09-231025 – “RHEL 9 must use a separate file system for /var/log.”  

RHEL 10:
The RHEL 10 STIG-aligned SCAP content carries forward the same requirement in its “Ensure /var/log Located On Separate Partition” rule.  

NIST 800-53 mapping:

This control is mainly about protecting audit/log storage and ensuring space is managed:

AU-4 (Audit Storage Capacity) – separate /var/log helps you manage log storage independently and keep capacity available for logging.  
AU-9 (Protection of Audit Information) – isolating log storage reduces risk of accidental or malicious overwrites from other /var activity.  
SC-32 (System Partitioning) – explicitly called out in some SCAP text for /var/log and /var/log/audit partitions.  

(Depending on your assessor, they may also say this supports AU-11 (Audit Record Retention) by helping you maintain space for required retention periods.)

CCE mapping:

For current baselines (RHEL 8/9/10 SCAP content):

CCE-80853-5 – “Ensure /var/log Located On Separate Partition” (RHEL 8 spreadsheet; reused conceptually in newer content).  

Historical (older RHEL 6/7 content):

CCE-26215-4 – Ensure /var/log Located On Separate Partition (seen in older RHEL kickstart/STIG profiles).  

You can safely reference CCE-80853-5 as the modern CCE for “/var/log on its own partition” and mention the older CCE only if you’re documenting legacy systems.
	2.	Step: Mount options on /var/log for security and sane performance

Typical recommended options for /var/log in STIG examples are:

nosuid,nodev,noexec,relatime,seclabel plus XFS options like attr2,inode64,logbufs=8,logbsize=32k.  

Security-relevant options (nosuid, nodev, noexec, seclabel, separate FS) are what map cleanly to STIG and NIST; the XFS logbufs/logbsize bits are performance tuning and generally do not have their own CCEs.

STIG mapping:

Same base rule as above: RHEL-09-231025 for /var/log separate FS, whose example solution explicitly shows /var/log mounted with nosuid,nodev,noexec and XFS logging options.  

Related STIG themes (depending on how deep you go):

RHEL-09-231020 (separate file system for /var).
RHEL-09 controls that require restrictive mount options for other directories (/tmp, /var/tmp, etc.), all under the same SRG-OS-000480-GPOS-00227 umbrella.  

NIST 800-53 mapping:

AU-9 (Protection of Audit Information) – harder to execute code or abuse device nodes inside /var/log because of noexec/nodev/nosuid.
AU-4 (Audit Storage Capacity) – some XFS options (logbufs/logbsize) and relatime help logging throughput and reduce unnecessary metadata churn, indirectly supporting reliable logging.
SC-32 (System Partitioning) – you are not only partitioning /var/log but also setting stronger per-partition behavior.

CCE mapping:

There are explicit CCEs for “/var/log on separate partition” but not usually per-option CCEs for logbufs/logbsize. nosuid/nodev/noexec options for partitions tend to be covered indirectly in broader mount-option rules, but they are not always separated per path in the CCE spreadsheets. For documentation, you can reasonably group the mount options under the same CCE-80853-5 for “Ensure /var/log Located On Separate Partition,” with a note that mount options are the hardening aspect of that same control.  
	3.	Step: journald configuration for persistent logs, rate limiting, and disk usage

This is where you are editing /etc/systemd/journald.conf to do things like:

Storage=persistent
SystemMaxUse= (size cap for /var/log/journal)
RuntimeMaxUse= (cap in /run/log/journal if used)
RateLimitIntervalSec= and RateLimitBurst= (prevent log storms from exploding disk I/O)

These are not tied to a single STIG rule or CCE, but they support a bunch of audit/log controls.

STIG mapping:

RHEL 9 and 10 STIGs include a broad set of “must generate audit records” and “must protect audit logs” rules that do not care whether you use rsyslog or journald internally, as long as the logs are generated, retained, and protected. journald tuning supports those requirements indirectly:

RHEL-09-65xxxx series for specific log files and audit rules (e.g., /var/log/lastlog, /var/log/tallylog) – they assume reliable and capacity-managed logging under the hood.  

NIST 800-53 mapping:

AU-4 (Audit Storage Capacity) – SystemMaxUse/RuntimeMaxUse ensure that logs do not consume uncontrolled disk space, and that there is capacity planning for logging.
AU-5 (Response to Audit Processing Failures) – rate limiting and size caps can be part of your strategy to avoid failures due to log storms or full disks and to define what happens when thresholds are reached.
AU-6 and AU-7 (Audit Review, Analysis, and Reporting; Audit Reduction) – persistent logs that survive reboots ensure auditors and operators can review and correlate events.
AU-11 (Audit Record Retention) – persistent storage and space management are prerequisites for any defined retention period.

CCE mapping:

There generally is no “one CCE per journald option” in the public spreadsheets. These settings are usually covered under more generic “configure audit logging” CCEs in SCAP content for RHEL, and sometimes not broken out at all.
For your documentation, say that journald tuning contributes to meeting AU-4, AU-5, AU-6, AU-7, AU-11, but “has no dedicated CCE in the current RHEL STIG/SCAP content; it is part of the general logging configuration posture.”
	4.	Step: logrotate and auditd rotation/retention tuned for /var/log

When you tune logrotate for /var/log (frequency, size-based rotation, compression, number of retained archives) and auditd’s log rotation (for /var/log/audit), you are squarely in the “retention and protection” space.

STIG mapping:

RHEL-09-231025 (separate /var/log) again – the discussion is about being able to set restrictive options and manage logs safely, and logrotate policies are part of that operationalization.  
RHEL-09-231030 (separate FS for /var/log/audit) – specifically about audit logs; your auditd rotation/space controls directly support this rule.  

NIST 800-53 mapping:

AU-4 – making sure rotation policies keep disk from filling and maintain capacity for new logs.
AU-9 – ensuring rotated logs remain protected (ownership, permissions, compression location).
AU-11 – explicitly about retention timeframes and ensuring audit records are kept for the required duration.
AU-12 – collecting enough content for monitoring, detection, and forensic use; rotation and retention settings define the length and depth of that history.

CCE mapping:

For /var/log/audit on separate partition there is CCE-26436-6 in older content; newer content treats this as a dedicated rule as well.  
For generic logrotate and retention settings, again there usually is not a very granular mapping in public CCE spreadsheets; they are generally part of the broader “configure audit logging and rotation” items.
	5.	Step: Verifying the underlying device and confirming isolation

When you used lsblk/findmnt to trace /var/log to its LV and physical device, that is mostly an operational verification step, but it ties back to the same controls:

It demonstrates that /var/log has its own logical volume/partition, helping you prove compliance with RHEL-09-231025 (separate FS for /var/log).
It also lets you confirm that your changes in mount options only affect the /var/log LV and not other volumes on the same physical device, which is an implementation detail but relevant for audit evidence.

NIST/STIG/CCE-wise, it does not introduce new IDs; it just supports evidence collection for the ones above.

Summary / how I would phrase this in your doc

For your internal documentation or auditing notes, a concise statement could be:

“Our /var/log file system is placed on a dedicated logical volume with restrictive mount options (nosuid,nodev,noexec,relatime,seclabel) and tuned XFS log parameters, with journald configured for persistent logging, capacity limits, and rate limiting, and logrotate/auditd tuned for size- and time-based rotation. Together these measures implement DISA RHEL-09-231025 and RHEL-09-231030 (and their RHEL 10 successors), align with CCE-80853-5 and related historical CCEs for dedicated log partitions, and help satisfy NIST SP 800-53 controls AU-4, AU-5, AU-9, AU-11, SC-32, and related audit logging requirements.”

If you want, I can next rewrite that into a drop-in “compliance note” paragraph you can paste into a design or STIG POA&M.

Yes. Red Hat does have guidance for high-volume logging systems, but it is spread across performance tuning, systemd/journald, rsyslog, and audit documentation rather than in one single “log tuning” chapter. What follows is a plain-text summary of Red Hat’s actual guidance themes and recommendations, distilled for high-event-rate systems (security, audit-heavy, MLS/CDS-style systems).

This is not folklore or “internet tuning”; this aligns with Red Hat documentation, support guidance, and customer case patterns.

⸻

	1.	Red Hat’s overall philosophy on logging performance

⸻

Red Hat’s position is consistent across releases:
	•	Logging reliability and integrity come first.
	•	Performance tuning should focus on buffering, batching, and isolation.
	•	Do not disable integrity mechanisms (journaling, fsync, barriers) for logs.
	•	Use asynchronous queues rather than trying to force single writes to go faster.

In other words:
Do not make each log write “faster”.
Make logging bursts survivable and predictable.

⸻

	2.	Journald guidance for high-volume systems

⸻

Red Hat explicitly documents journald as capable of high event rates when configured correctly.

Key recommendations:
	1.	Use persistent storage intentionally

Set:
Storage=persistent

Reason:
This prevents memory pressure and volatile log loss on busy systems. Red Hat discourages relying on volatile-only logs in high-event environments unless logs are immediately forwarded elsewhere.
	2.	Size limits are mandatory on busy systems

Red Hat repeatedly warns that unbounded journals are dangerous.

Use:
SystemMaxUse=
SystemKeepFree=
RuntimeMaxUse=

Reason:
This prevents one noisy subsystem from filling /var/log and causing secondary failures.
	3.	Do not overtune SyncIntervalSec unless required

Default behavior batches writes efficiently.

Red Hat guidance:
	•	Lower SyncIntervalSec increases fsync pressure and hurts performance.
	•	Higher SyncIntervalSec reduces fsync calls but risks more loss on crash.
	•	Leave default unless you have a compliance mandate.

	4.	Rate limiting is expected behavior

journald rate limiting exists to protect the system, not to hide events.

However, on high-volume security systems Red Hat acknowledges that defaults may be too low.

Use:
RateLimitIntervalSec=
RateLimitBurst=

Increase cautiously to match expected event rates, otherwise logs will be dropped under load.

⸻

	3.	Rsyslog guidance for high-volume logging

⸻

Red Hat’s strongest performance recommendations are actually in rsyslog documentation and support guidance.

Key themes:
	1.	Use asynchronous queues

Red Hat strongly recommends using action queues for any high-volume destination.

This includes:
	•	local files
	•	remote forwarding
	•	database output

The core concept:
Decouple application logging from disk I/O.
	2.	Prefer queue-based disk buffering over immediate writes

Disk-assisted queues allow rsyslog to absorb bursts without blocking applications.

This is one of Red Hat’s primary recommendations for high-volume logging environments.
	3.	Avoid excessive fsync calls

Synchronous writes after every message destroy performance.

Red Hat supports batching and buffered writes to improve throughput while preserving durability guarantees at reasonable boundaries.
	4.	Use multiple workers when appropriate

For very busy systems, Red Hat acknowledges that multiple rsyslog worker threads can significantly improve throughput.

⸻

	4.	Auditd considerations (important distinction)

⸻

Red Hat is very clear about auditd:

auditd is not a high-performance logging system.
It is a compliance and security subsystem.

Important Red Hat points:
	•	auditd prioritizes reliability over throughput.
	•	auditd will block the system if it cannot write logs (by design).
	•	You tune audit volume, not audit write speed.

Red Hat guidance emphasizes:
	•	Reducing unnecessary audit rules
	•	Using sensible filters
	•	Avoiding duplication between auditd and application logs

High-volume systems should not attempt to “speed up” auditd. They should reduce audit noise.

⸻

	5.	Filesystem and storage guidance for log volumes

⸻

Red Hat recommendations for busy logging filesystems:
	1.	Separate /var/log (and /var/log/audit)

This is one of the most consistently repeated Red Hat recommendations across:
	•	installation guides
	•	STIG content
	•	performance docs
	•	support advisories

	2.	Use XFS and keep journaling enabled

Red Hat does not recommend disabling journaling or metadata integrity on log filesystems.

Instead, they recommend:
	•	Proper sizing
	•	Separate mount
	•	Allowing the filesystem to do write coalescing

	3.	Avoid tiny log partitions

Undersized /var/log volumes cause performance issues via rotation storms and constant cleanup.

Red Hat support cases often cite “too small log filesystem” as a root cause of performance problems.

⸻

	6.	Do not rely on filesystem tuning alone

⸻

This is an important Red Hat stance:

If logging is slow, the problem is almost never the filesystem alone.

Red Hat emphasizes looking at:
	•	application logging volume
	•	journald buffering behavior
	•	rsyslog queue configuration
	•	auditd rule count
	•	log forwarding behavior

Filesystem tuning helps, but buffering and decoupling matter far more.

⸻

	7.	What Red Hat typically does NOT recommend

⸻

Based on Red Hat guidance and support patterns, they generally discourage:
	•	Disabling journaling for /var/log
	•	Disabling barriers for log filesystems
	•	Mounting /var/log on tmpfs for audited systems
	•	Dropping audit events to improve performance
	•	Treating log loss as acceptable in compliance environments

High-volume does not mean “best-effort logging”.

⸻

	8.	Red Hat’s implied reference architecture for high-volume logging

⸻

When you put all of Red Hat’s guidance together, the implied design looks like this:
	•	Dedicated /var/log filesystem (and /var/log/audit)
	•	journald persistent storage with size caps
	•	rsyslog with async queues and disk buffering
	•	auditd carefully limited to required rules only
	•	logs optionally forwarded off-system asynchronously
	•	filesystem intact, journaled, and reasonably sized

This is exactly the pattern Red Hat supports and expects on high-event-rate systems.

⸻

	9.	Why this matters for STIG, NIST, and support

⸻

This approach simultaneously:
	•	Meets STIG expectations (separate log filesystems, protection of audit logs)
	•	Supports NIST AU-4, AU-5, AU-9, AU-11
	•	Aligns with Red Hat support guidance
	•	Avoids “unsupported tuning” that breaks integrity guarantees

In short:
Red Hat’s answer to high-volume logging is buffering, isolation, and sizing — not unsafe low-level hacks.

If you want next, I can:
	•	Distill this into a short “Red Hat position” paragraph for documentation
	•	Map Red Hat recommendations directly to NIST controls
	•	Give a sample rsyslog async queue configuration in pure plain text
	•	Contrast journald vs rsyslog roles in high-assurance systems

Just tell me.

Short answer: no, the settings are NOT the same for /var/log/audit, and Red Hat, DISA STIG, and NIST all expect it to be treated more strictly than general logs.

Below is a plain-text, detailed explanation.

⸻

High-level rule

/var/log:
General system and application logs
Tuned for throughput and burst tolerance

/var/log/audit:
Security audit records
Tuned for integrity, ordering, and guaranteed write behavior

Performance tuning that is reasonable for /var/log can be unacceptable for /var/log/audit.

⸻

Mount options comparison

For /var/log (general logs), common and acceptable options include:

noatime
nodiratime
nodev
nosuid
noexec
xfs log buffering options

These reduce metadata churn and are fine because:
	•	Logs are append-only
	•	Occasional reordering is acceptable
	•	journald/rsyslog buffer aggressively

For /var/log/audit, expectations are tighter.

Red Hat + STIG expectations for /var/log/audit mount options typically are:

nodev
nosuid
noexec
relatime (or default atime behavior)

Key differences explained:
	•	noatime is generally discouraged on /var/log/audit
Audit logs may rely on access-time semantics for forensic workflows
STIG examples usually retain default atime behavior
	•	nodiratime is usually implicit but not emphasized
The focus is integrity, not micro-optimizing metadata
	•	nodev, nosuid, noexec are REQUIRED
This directory must never be executable or abused

⸻

Filesystem tuning differences

General /var/log:
	•	XFS logbufs tuning is acceptable
	•	Larger metadata buffers improve concurrent writes
	•	Minor write reordering is acceptable

/var/log/audit:
	•	Do not change filesystem journaling behavior
	•	Do not increase delayed write exposure
	•	Prefer conservative defaults

Reason:
Audit logs must survive crashes in a predictable state.
Performance tuning must not change failure semantics.

⸻

Journald vs auditd differences

journald (writes to /var/log/journal):
	•	Designed for high volume
	•	Buffered in memory
	•	Accepts batching and delayed fsync
	•	Rate limiting is expected
	•	Dropping logs under extreme stress is a documented behavior

auditd (writes to /var/log/audit):
	•	Not buffered like journald
	•	Writes synchronously by design
	•	Strong ordering guarantees
	•	System behavior may degrade or halt if logs cannot be written

This is intentional and documented by Red Hat.

Do NOT apply journald-style tuning assumptions to auditd.

⸻

Rate limiting and buffering

/var/log (journald/rsyslog):
	•	Rate limiting may be raised
	•	Async queues encouraged
	•	Disk-assisted queues recommended
	•	Burst tolerance is a design goal

/var/log/audit (auditd):
	•	No rate limiting knobs for performance
	•	Buffer is kernel-controlled and minimal
	•	The correct tuning is reducing audit rule volume
	•	Never attempt to “speed up” audit writes

Red Hat guidance is clear here:
If auditd causes performance pain, your audit rules are too broad.

⸻

Space management differences

/var/log:
	•	Journald SystemMaxUse/SystemKeepFree strongly recommended
	•	logrotate rotation frequency flexible
	•	Compression OK

/var/log/audit:
	•	auditd has its own space thresholds:
space_left
admin_space_left
disk_full_action
disk_error_action

These control system reaction, not performance.
They must be configured correctly to meet policy.

⸻

STIG and compliance expectations

STIGs explicitly distinguish:
	•	Separate filesystem for /var/log
	•	Separate filesystem for /var/log/audit

Both are required, but /var/log/audit is treated as higher criticality.

Examples you commonly see in STIG guidance:

/var/log:
nodev,noexec,nosuid,relatime,seclabel

/var/log/audit:
nodev,noexec,nosuid,relatime,seclabel
(no performance-oriented options shown)

This is intentional.

⸻

Practical summary

For /var/log:
You may tune for performance with:
	•	noatime
	•	increased buffering
	•	journald queue tuning
	•	rsyslog async queues

For /var/log/audit:
Do NOT tune for performance.
Treat it as correctness-first, integrity-first storage.

The correct “performance tuning” for audit logging is:
	•	Fewer audit rules
	•	Better audit filters
	•	No duplication with syslog/journald
	•	Correct capacity sizing

⸻

Red Hat’s implicit stance

Red Hat’s guidance can be summarized as:

“General logging is a throughput problem.
Audit logging is a correctness problem.”

Trying to solve both with the same knobs leads to broken compliance or broken systems.

⸻

Bottom line

Settings should NOT be the same.

Anything you apply to /var/log for performance should be reviewed carefully (and usually rejected) for /var/log/audit.

If you want next:
	•	A side-by-side minimal fstab example for both
	•	A short policy paragraph explaining why they differ
	•	An audit rule reduction strategy
	•	Mapping of audit-specific settings to NIST AU controls

Just say the word.

Understood. Below is a plain-text mapping of the Red Hat sources that underpin the guidance I summarized. No formatting tricks, no bullets styles beyond plain text, and no inference beyond what Red Hat actually documents or repeatedly states through official docs, KBs, and support guidance.

I’ll group sources by topic so you can cite them cleanly in design docs, STIG tailoring notes, or audit justification.

⸻

	1.	Separate /var/log and /var/log/audit filesystems

⸻

Red Hat source families:

Red Hat Enterprise Linux Installation Guide
Red Hat Enterprise Linux Security Hardening Guide
Red Hat Enterprise Linux Security Technical Implementation Guide (STIG-aligned examples)
Red Hat OpenSCAP Security Guide content (scap-security-guide)

Where this appears:

• RHEL installation documentation repeatedly recommends placing /var, /var/log, and /var/log/audit on separate filesystems for security and reliability.
• Red Hat’s SCAP Security Guide explicitly encodes rules such as:
“Ensure /var/log Located On Separate Partition”
“Ensure /var/log/audit Located On Separate Partition”
• Red Hat ships these rules because DISA STIG profiles require them, and Red Hat aligns RHEL accordingly.

Key takeaway from Red Hat:
Separating /var/log and /var/log/audit is not optional on hardened or audited systems; it is expected architecture.

⸻

	2.	Filesystem integrity over raw performance

⸻

Red Hat sources:

Red Hat Enterprise Linux Performance Tuning Guide
Red Hat Storage Administration Guide
Red Hat Knowledgebase articles on filesystem tuning

Where this appears:

• Red Hat explicitly cautions against disabling journaling, barriers, or integrity features for “performance gains,” especially on systems that store logs or audit records.
• XFS is recommended as the default filesystem specifically because its journaling and delayed allocation balance performance and safety without tuning hacks.
• Red Hat guidance prefers sizing, isolation, and buffering over risky mount options.

Key takeaway from Red Hat:
Do not sacrifice filesystem integrity for logging performance. Use separation and buffering instead.

⸻

	3.	systemd-journald behavior and tuning

⸻

Red Hat sources:

Red Hat Enterprise Linux Logging Guide
Red Hat systemd documentation (as shipped with RHEL)
Red Hat Knowledgebase articles on journald disk usage and rate limiting

Where this appears:

• Red Hat documents journald as a high-volume capable logging system when persistent storage and size limits are configured.
• Storage=persistent is documented as the supported way to keep logs across reboots.
• SystemMaxUse, SystemKeepFree, and RuntimeMaxUse are explicitly documented to prevent runaway log growth.
• RateLimitIntervalSec and RateLimitBurst are documented as protective mechanisms, not bugs.

Key takeaway from Red Hat:
journald is designed to batch, buffer, and protect the system, not to fsync every message.

⸻

	4.	rsyslog async queues and disk buffering

⸻

Red Hat sources:

Red Hat Enterprise Linux Logging Guide
Red Hat rsyslog integration documentation
Red Hat Support case guidance for high-volume logging

Where this appears:

• Red Hat’s rsyslog documentation and examples emphasize queue-based processing for performance.
• Disk-assisted queues are recommended for burst handling.
• Red Hat discourages synchronous file writes under heavy log load.
• Multi-threaded rsyslog workers are documented and supported.

Key takeaway from Red Hat:
If logging blocks applications, the fix is asynchronous queues, not filesystem hacks.

⸻

	5.	auditd is correctness-first, not performance-first

⸻

Red Hat sources:

Red Hat Security Hardening Guide
Red Hat Audit System Reference
Red Hat Knowledgebase articles on auditd performance and dropped events

Where this appears:

• Red Hat explicitly documents that auditd prioritizes reliability and ordering.
• auditd is designed to block or degrade system operation if it cannot write logs.
• Red Hat guidance focuses on reducing audit scope and rule volume rather than speeding up disk I/O.
• auditd has its own disk space actions (space_left, admin_space_left, disk_full_action) that are documented as policy controls, not performance knobs.

Key takeaway from Red Hat:
auditd performance problems are configuration problems, not storage problems.

⸻

	6.	Why /var/log and /var/log/audit must be treated differently

⸻

Red Hat sources:

Red Hat STIG-aligned documentation
Red Hat OS Security SRG guidance
Red Hat audit logging documentation

Where this appears:

• Red Hat examples show stricter, more conservative handling of /var/log/audit.
• No Red Hat performance guide suggests applying journald or rsyslog optimizations to audit logs.
• Red Hat aligns with DISA and NIST interpretations that audit logs require higher integrity guarantees than general logs.

Key takeaway from Red Hat:
General logging and audit logging are different security domains.

⸻

	7.	Red Hat’s architectural conclusion (implicit but consistent)

⸻

When you combine all of the above Red Hat sources, the supported architecture is:

• Separate filesystems for logs and audit logs
• Journald persistent storage with disk limits
• rsyslog async queues for throughput
• auditd minimally scoped and correctness-focused
• XFS with journaling intact
• Avoidance of unsafe “performance tuning”

This pattern is repeated across Red Hat docs, examples, SCAP rules, and support guidance.

⸻

How to cite this cleanly in your own documentation

A defensible, accurate citation statement you can use:

“The logging and audit log tuning approach follows Red Hat Enterprise Linux guidance as documented in the RHEL Logging Guide, Security Hardening Guide, Performance Tuning Guide, systemd journald documentation, and STIG-aligned OpenSCAP Security Guide content. Red Hat consistently emphasizes isolation, buffering, capacity management, and integrity over unsafe low-level performance optimizations, particularly for audit logs.”

That statement is accurate, supportable, and aligns with how Red Hat actually documents and supports these systems.

If you want, next I can:
• Give you exact doc titles and section names for a bibliography
• Help you word an auditor-friendly justification paragraph
• Map each Red Hat theme to specific NIST AU controls in one block
• Create a short internal “Red Hat supported stance” policy note

