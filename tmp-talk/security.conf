#
# Example /etc/tmpfiles.d/security.conf
#
# 
# READ THE DOCUMENTATION AND TEST, TEST, AND TEST!
#
#
# How to use this file
# ------------------
# Create or edit /etc/tmpfiles.d/security.conf.
# Preview behavior using
#   sudo systemd-tmpfiles –create –remove –boot –dry-run
#
# Apply changes using
#   sudo systemd-tmpfiles –create
#   sudo systemd-tmpfiles –remove
#
# Verify results using
#   ls -ld
#   ls -Z
#
# Reboot once to confirm consistent behavior.
#
# Field Descriptions
# ------------------
# Type: A single letter (optionally followed by !, -, or +) specifying the action. 
#       Common types include:
#       d: Create a directory if it does not exist.
#       f: Create a file if it does not exist.
#       L: Create a symbolic link.
#       r: Remove a file or directory (only if empty).
#       R: Recursively remove a file or directory and its contents.
#       Z: Adjust mode, ownership, and SELinux context of a file or directory.
#       w: Write the argument string to a file.
#
# Path:  The absolute filesystem path for the target.
# Mode:  The access mode (permissions) in octal representation (e.g., 0755). If omitted or set to -, a default is used.
# User:  The owner user name or ID. If omitted or set to -, root is assumed.
# Group: The owner group name or ID. If omitted or set to -, root is assumed.
# Age:   A time value (e.g., 10d for 10 days, 1w for one week) used by systemd-tmpfiles --clean to determine if a file should be deleted. If omitted or set to -, no age-based cleanup is performed for that entry. An age of 0 means unconditional cleanup.
#
# Argument: Used differently depending on the Type:
# - For L (symlink), it is the destination path.
# - For f or w (write file), it is the string content to write to the file.
# - For C (copy), it specifies the source file or directory.
# - Ignored for most other types.  
# ------------------
#
#Type  Path  Mode  User  Group Age Argument

# Clean /tmp and /var/tmp by removing stuff older than 10 and 30 days respectively.
d /tmp 1777 root root -
D /tmp - - - 10d -

d /var/tmp 1777 root root -
D /var/tmp - - - 30d -

# This example creates:
#  = A directory /run/myapp with mode 0755, owned by myapp user and myapp 
#    group, which is not subject to age-based cleaning.
#  - A file /tmp/mylock with default mode/ownership, which will be removed 
#    if older than 1 day, containing the text "LOCK_DATA".
# 
# Type Path       Mode  User  Group Age  Argument
# d    /run/myapp 0755  myapp myapp   -  -
# f    /tmp/mylock -     -     -     1d  "LOCK_DATA"

# Let's say you're running two apache servers. Each
# a different fixed security level like s0 and s4. 
# YOu can have different rules for them.
#
# d /run/httpd-public 0750 apache apache -
# D /run/httpd-public - - - 1d -

# d /run/httpd-controlled 0750 apache apache -
# D /run/httpd-controlled - - - 1d -

# d /var/tmp/httpd-public 0700 apache apache -
# D /var/tmp/httpd-public - - - 7d -

# d /var/tmp/httpd-controlled 0700 apache apache -
# D /var/tmp/httpd-controlled - - - 3d -

# z /run/httpd-public 0750 apache apache -
# z /run/httpd-controlled 0750 apache apache -

# z /var/tmp/httpd-public 0700 apache apache -
# z /var/tmp/httpd-controlled 0700 apache apache -
